sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/ui/core/format/DateFormat","sap/ui/core/format/NumberFormat"],function(e,t,a,o,n){"use strict";return e.extend("demoapp.controller.View1",{onInit:function(){var e=new t("model/data.json");this.getView().setModel(e,"datamodel")},ondownload:function(){var e=this.getView().getModel("datamodel");var t=e.getProperty("/employees");a.show("Do you want to download the data?",a.Icon.QUESTION,"Confirmation",[a.Action.YES,a.Action.NO],function(e){if(e===a.Action.YES){var o=XLSX.utils.book_new();var n=t.map(function(e){return{ID:e.id,Firstname:e.firstname,Lastname:e.Lastname,Phonenumber:e.phonenumber.toString(),Role:e.role,Joindate:e.Joindate?new Date(e.Joindate).toLocaleDateString("en-GB").replace(/\//g,"/"):""}});var r=["ID","Firstname","Lastname","Phonenumber","Role","Joindate"];var i=XLSX.utils.aoa_to_sheet([r]);XLSX.utils.sheet_add_json(i,n,{skipHeader:true,origin:"A2"});i["!cols"]=r.map(function(){return{width:15}});var s=XLSX.utils.decode_range(i["!ref"]);for(var l=s.s.r;l<=s.e.r;l++){for(var d=s.s.c;d<=s.e.c;d++){var m=XLSX.utils.encode_cell({r:l,c:d});var u=i[m];if(u&&u.v){var c=m.replace(/[0-9]/g,"");if(c==="D"){u.t="s";u.z="0"}else if(c==="F"){if(u.v){var v=u.v.split("/");if(v.length===3){var p=parseInt(v[0],10);var f=parseInt(v[1],10)-1;var g=parseInt(v[2],10);var X=new Date(Date.UTC(g,f,p));if(!isNaN(X.getTime())){u.t="n";u.z="dd/mm/yyyy";u.v=X.getTime()/864e5+25569}else{u.v=""}}else{u.v=""}}}else{u.t="s";u.z="@"}}}}XLSX.utils.book_append_sheet(o,i,"Employees");XLSX.writeFile(o,"Employees.xlsx")}})}})});
//# sourceMappingURL=View1.controller.js.map